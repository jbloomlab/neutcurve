<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Fitting curves to real data &#8212; neutcurve 2.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=c878986b" />
    <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="_static/documentation_options.js?v=20623aea"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Constrain fit parameters to a range of reasonable values" href="constrain_params_range.html" />
    <link rel="prev" title="Hill-curve neutralization" href="hillcurve_example.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Fitting-curves-to-real-data">
<h1>Fitting curves to real data<a class="headerlink" href="#Fitting-curves-to-real-data" title="Link to this heading">¶</a></h1>
<section id="Overview">
<h2>Overview<a class="headerlink" href="#Overview" title="Link to this heading">¶</a></h2>
<p>When you have a real dataset, the easiest way to fit it is via the <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits</span></code> class, which streamlines the fitting and plotting of a set of <code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve</span></code> neutralization curves. Here we demonstrate how to do this.</p>
</section>
<section id="Importing-Python-packages">
<h2>Importing Python packages<a class="headerlink" href="#Importing-Python-packages" title="Link to this heading">¶</a></h2>
<p>First, import the necessary Python modules. In addition to the <code class="docutils literal notranslate"><span class="pre">neutcurve</span></code> package itself, we also use <a class="reference external" href="https://pandas.pydata.org/">pandas</a> to hold the data:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">neutcurve</span>
<span class="kn">from</span> <span class="nn">neutcurve.colorschemes</span> <span class="kn">import</span> <span class="n">CBMARKERS</span><span class="p">,</span> <span class="n">CBPALETTE</span>
</pre></div>
</div>
</div>
<p>Set some pandas display options:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.float_format&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{:.3g}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_columns&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.width&quot;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Preparing-the-data">
<h2>Preparing the data<a class="headerlink" href="#Preparing-the-data" title="Link to this heading">¶</a></h2>
<p>Now we get example data to fit. We use as our example the neutralization of variants A/WSN/1933 (H1N1) influenza by the broadly neutralizing antibody FI6v3 and strain-specific antibody H17-L19 from <a class="reference external" href="https://www.nature.com/articles/s41467-018-03665-3#Fig6">Fig 6a,b of Doud et al (2018)</a>. We start by reading these data into a pandas DataFrame:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fi6v3_datafile</span> <span class="o">=</span> <span class="s2">&quot;Doud_et_al_2018-neutdata.csv&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fi6v3_datafile</span><span class="p">)</span>

<span class="c1"># drop replicate 2 for one serum as this helps with some plot testing below</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;serum&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;H17-L19&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;replicate&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<p>Here are the first few lines of the data frame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>serum</th>
      <th>virus</th>
      <th>replicate</th>
      <th>concentration</th>
      <th>fraction infectivity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>1</td>
      <td>0.000205</td>
      <td>1.01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>1</td>
      <td>0.000478</td>
      <td>0.942</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>1</td>
      <td>0.00112</td>
      <td>0.993</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>1</td>
      <td>0.0026</td>
      <td>0.966</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>1</td>
      <td>0.00607</td>
      <td>0.957</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>And here are the last few lines:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>serum</th>
      <th>virus</th>
      <th>replicate</th>
      <th>concentration</th>
      <th>fraction infectivity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>427</th>
      <td>H17-L19</td>
      <td>V135T</td>
      <td>3</td>
      <td>0.386</td>
      <td>1.02</td>
    </tr>
    <tr>
      <th>428</th>
      <td>H17-L19</td>
      <td>V135T</td>
      <td>3</td>
      <td>0.9</td>
      <td>1</td>
    </tr>
    <tr>
      <th>429</th>
      <td>H17-L19</td>
      <td>V135T</td>
      <td>3</td>
      <td>2.1</td>
      <td>0.959</td>
    </tr>
    <tr>
      <th>430</th>
      <td>H17-L19</td>
      <td>V135T</td>
      <td>3</td>
      <td>4.9</td>
      <td>0.991</td>
    </tr>
    <tr>
      <th>431</th>
      <td>H17-L19</td>
      <td>V135T</td>
      <td>3</td>
      <td>11.4</td>
      <td>0.747</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>As can be seen above, the data are organized into five columns, all of which must be present. These columns are:</p>
<ul class="simple">
<li><p><em>serum</em>: the name of the serum (or antibody). FI6v3 and H17-L19 are actually antibodies, not sera, but <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits</span></code> is set up to refer to things as serum.</p></li>
<li><p><em>virus</em>: the name of the virus being neutralized by the serum.</p></li>
<li><p><em>replicate</em>: the replicate label for the measurement. Although you can have just one replicate, it’s good experimental practice to have several. All the replicates for a given virus / serum combination must have been measured at the same concentrations.</p></li>
<li><p><em>concentration</em>: the concentration of the serum.</p></li>
<li><p><em>fraction infectivity</em>: the fraction infectivity of the virus at this concentration of the serum measured in this replicate.</p></li>
</ul>
<p>Note that the data are in <a class="reference external" href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html">tidy form</a>; you must make your data frame tidy before you can analyze it with <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits</span></code>.</p>
</section>
<section id="Fitting-the-curves">
<h2>Fitting the curves<a class="headerlink" href="#Fitting-the-curves" title="Link to this heading">¶</a></h2>
<p>Once you have the tidy data frame, it’s easy to pass it to <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits</span></code>. We expect all of these antibodies to go to complete neutralization when they are effective, so we use default values of and argument (see <code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurves</span></code> and Hill-curve neutralization for more details about the and options):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span> <span class="o">=</span> <span class="n">neutcurve</span><span class="o">.</span><span class="n">CurveFits</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we can look at the different sera for which we have fit curves:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">sera</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;FI6v3&#39;, &#39;H17-L19&#39;]
</pre></div></div>
</div>
<p>We can also look at the viruses measured against each serum:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">serum</span> <span class="ow">in</span> <span class="n">fits</span><span class="o">.</span><span class="n">sera</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Viruses measured against </span><span class="si">{</span><span class="n">serum</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">viruses</span><span class="p">[</span><span class="n">serum</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Viruses measured against FI6v3:
[&#39;WT&#39;, &#39;K(-8T)&#39;, &#39;P80D&#39;, &#39;V135T&#39;, &#39;K280A&#39;, &#39;K280S&#39;, &#39;K280T&#39;, &#39;N291S&#39;, &#39;M17L-HA2&#39;, &#39;G47R-HA2&#39;]
Viruses measured against H17-L19:
[&#39;WT&#39;, &#39;V135T&#39;]
</pre></div></div>
</div>
<p>We can also look at the replicates for each serum and virus. Here we just do that for serum <em>FI6v3</em> and virus <em>WT</em>. See how in addition to the three replicates we have passed, there is also now an “average” replicate that is automatically computed from the average of the other replicates:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">replicates</span><span class="p">[(</span><span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span> <span class="s2">&quot;WT&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;average&#39;]
</pre></div></div>
</div>
</section>
<section id="Looking-at-a-specific-curve">
<h2>Looking at a specific curve<a class="headerlink" href="#Looking-at-a-specific-curve" title="Link to this heading">¶</a></h2>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.getCurve()</span></code> method to get the <code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve</span></code> that was fit for a particular serum / virus / replicate combination. For instance, here we do that for <em>serum</em> FI6v3 versus <em>virus</em> WT for replicate <em>1</em>. We then plot the curve and print the IC50:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">curve</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getCurve</span><span class="p">(</span><span class="n">serum</span><span class="o">=</span><span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span> <span class="n">virus</span><span class="o">=</span><span class="s2">&quot;WT&quot;</span><span class="p">,</span> <span class="n">replicate</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The IC50 is </span><span class="si">{</span><span class="n">curve</span><span class="o">.</span><span class="n">ic50</span><span class="p">()</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The IC50 is 0.0167
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_20_1.png" src="_images/curvefits_example_20_1.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits</span></code> also calculates the average and standard error of the measurements for each serum / virus, and fits them under a replicate name of “average”. Here is the fit to the average of the data for <em>serum</em> FI6v3 and <em>virus</em> WT. Note how the plot now also shows error bars indicating the standard error:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">curve</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getCurve</span><span class="p">(</span><span class="n">serum</span><span class="o">=</span><span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span> <span class="n">virus</span><span class="o">=</span><span class="s2">&quot;WT&quot;</span><span class="p">,</span> <span class="n">replicate</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The IC50 is </span><span class="si">{</span><span class="n">curve</span><span class="o">.</span><span class="n">ic50</span><span class="p">()</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The IC50 is 0.017
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_22_1.png" src="_images/curvefits_example_22_1.png" />
</div>
</div>
</section>
<section id="Accessing-the-fit-parameters-for-all-curves">
<h2>Accessing the fit parameters for all curves<a class="headerlink" href="#Accessing-the-fit-parameters-for-all-curves" title="Link to this heading">¶</a></h2>
<p>You can get the fit parameters for the curves using <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.fitParams()</span></code>. By default, this just gets the fits for the average of the replicates. The parameters are all of those fit by a <code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve</span></code>, plus the IC50 in several forms to accurately represent interpolated IC50s (IC50 within range of data) versus IC50s where we can just get the bound from the upper or lower limits of the data:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">fitParams</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>serum</th>
      <th>virus</th>
      <th>replicate</th>
      <th>nreplicates</th>
      <th>ic50</th>
      <th>ic50_bound</th>
      <th>ic50_str</th>
      <th>midpoint</th>
      <th>midpoint_bound</th>
      <th>midpoint_bound_type</th>
      <th>slope</th>
      <th>top</th>
      <th>bottom</th>
      <th>r2</th>
      <th>rmsd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>average</td>
      <td>3</td>
      <td>0.017</td>
      <td>interpolated</td>
      <td>0.017</td>
      <td>0.017</td>
      <td>0.017</td>
      <td>interpolated</td>
      <td>2.28</td>
      <td>1</td>
      <td>0</td>
      <td>0.992</td>
      <td>0.0389</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FI6v3</td>
      <td>K(-8T)</td>
      <td>average</td>
      <td>3</td>
      <td>0.0283</td>
      <td>interpolated</td>
      <td>0.0283</td>
      <td>0.0283</td>
      <td>0.0283</td>
      <td>interpolated</td>
      <td>2.4</td>
      <td>1</td>
      <td>0</td>
      <td>0.986</td>
      <td>0.0592</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FI6v3</td>
      <td>P80D</td>
      <td>average</td>
      <td>3</td>
      <td>0.0123</td>
      <td>interpolated</td>
      <td>0.0123</td>
      <td>0.0123</td>
      <td>0.0123</td>
      <td>interpolated</td>
      <td>2.05</td>
      <td>1</td>
      <td>0</td>
      <td>0.99</td>
      <td>0.0467</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FI6v3</td>
      <td>V135T</td>
      <td>average</td>
      <td>3</td>
      <td>0.0229</td>
      <td>interpolated</td>
      <td>0.0229</td>
      <td>0.0229</td>
      <td>0.0229</td>
      <td>interpolated</td>
      <td>1.83</td>
      <td>1</td>
      <td>0</td>
      <td>0.995</td>
      <td>0.0328</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FI6v3</td>
      <td>K280A</td>
      <td>average</td>
      <td>3</td>
      <td>0.0106</td>
      <td>interpolated</td>
      <td>0.0106</td>
      <td>0.0106</td>
      <td>0.0106</td>
      <td>interpolated</td>
      <td>1.86</td>
      <td>1</td>
      <td>0</td>
      <td>0.981</td>
      <td>0.0655</td>
    </tr>
    <tr>
      <th>5</th>
      <td>FI6v3</td>
      <td>K280S</td>
      <td>average</td>
      <td>3</td>
      <td>0.0428</td>
      <td>interpolated</td>
      <td>0.0428</td>
      <td>0.0428</td>
      <td>0.0428</td>
      <td>interpolated</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0.993</td>
      <td>0.0376</td>
    </tr>
    <tr>
      <th>6</th>
      <td>FI6v3</td>
      <td>K280T</td>
      <td>average</td>
      <td>3</td>
      <td>0.0348</td>
      <td>interpolated</td>
      <td>0.0348</td>
      <td>0.0348</td>
      <td>0.0348</td>
      <td>interpolated</td>
      <td>1.82</td>
      <td>1</td>
      <td>0</td>
      <td>0.993</td>
      <td>0.0375</td>
    </tr>
    <tr>
      <th>7</th>
      <td>FI6v3</td>
      <td>N291S</td>
      <td>average</td>
      <td>3</td>
      <td>0.0845</td>
      <td>interpolated</td>
      <td>0.0845</td>
      <td>0.0845</td>
      <td>0.0845</td>
      <td>interpolated</td>
      <td>1.8</td>
      <td>1</td>
      <td>0</td>
      <td>0.997</td>
      <td>0.0228</td>
    </tr>
    <tr>
      <th>8</th>
      <td>FI6v3</td>
      <td>M17L-HA2</td>
      <td>average</td>
      <td>3</td>
      <td>0.0198</td>
      <td>interpolated</td>
      <td>0.0198</td>
      <td>0.0198</td>
      <td>0.0198</td>
      <td>interpolated</td>
      <td>2.06</td>
      <td>1</td>
      <td>0</td>
      <td>0.989</td>
      <td>0.0483</td>
    </tr>
    <tr>
      <th>9</th>
      <td>FI6v3</td>
      <td>G47R-HA2</td>
      <td>average</td>
      <td>3</td>
      <td>0.0348</td>
      <td>interpolated</td>
      <td>0.0348</td>
      <td>0.0348</td>
      <td>0.0348</td>
      <td>interpolated</td>
      <td>2.6</td>
      <td>1</td>
      <td>0</td>
      <td>0.982</td>
      <td>0.0674</td>
    </tr>
    <tr>
      <th>10</th>
      <td>H17-L19</td>
      <td>WT</td>
      <td>average</td>
      <td>2</td>
      <td>0.106</td>
      <td>interpolated</td>
      <td>0.106</td>
      <td>0.106</td>
      <td>0.106</td>
      <td>interpolated</td>
      <td>4.04</td>
      <td>1</td>
      <td>0</td>
      <td>0.99</td>
      <td>0.0518</td>
    </tr>
    <tr>
      <th>11</th>
      <td>H17-L19</td>
      <td>V135T</td>
      <td>average</td>
      <td>2</td>
      <td>11.4</td>
      <td>lower</td>
      <td>&gt;11.4</td>
      <td>16.9</td>
      <td>11.4</td>
      <td>lower</td>
      <td>2.36</td>
      <td>1</td>
      <td>0</td>
      <td>0.708</td>
      <td>0.052</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Looking above, you can see how the IC50 is handled depending on if it is interpolated (in the range of concentrations used in the experiments) versus outside the range of concentrations. In the table above, all of the IC50s are interpolated <strong>except</strong> the last row (H17-L19 versus V135T), which is just provided as an upper bound equal to the highest concentration used in the experiment (the actual IC50 is greater than this upper bound). We do <strong>not</strong> attempt to extrapolate IC50s outside the data
range as this is unreliable.</p>
<p>You can see there is also a column (“r2”) that reports the <a class="reference external" href="https://en.wikipedia.org/wiki/Coefficient_of_determination">coefficient of determination</a> as a measure of how well the curve fits the data.</p>
<p>Note that by default, <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.fitParams()</span></code> only returns the fitted params for the averages, as in the above table. If you want to also return them for individual replicates, using argument <code class="docutils literal notranslate"><span class="pre">average_only=False</span></code>. Here we do this, showing only the first few entries in the returned data frame; now there are now values for each replicate as well as the average of replicates:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">fitParams</span><span class="p">(</span><span class="n">average_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>serum</th>
      <th>virus</th>
      <th>replicate</th>
      <th>nreplicates</th>
      <th>ic50</th>
      <th>ic50_bound</th>
      <th>ic50_str</th>
      <th>midpoint</th>
      <th>midpoint_bound</th>
      <th>midpoint_bound_type</th>
      <th>slope</th>
      <th>top</th>
      <th>bottom</th>
      <th>r2</th>
      <th>rmsd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>0.0167</td>
      <td>interpolated</td>
      <td>0.0167</td>
      <td>0.0167</td>
      <td>0.0167</td>
      <td>interpolated</td>
      <td>2.5</td>
      <td>1</td>
      <td>0</td>
      <td>0.996</td>
      <td>0.0284</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>0.019</td>
      <td>interpolated</td>
      <td>0.019</td>
      <td>0.019</td>
      <td>0.019</td>
      <td>interpolated</td>
      <td>2.51</td>
      <td>1</td>
      <td>0</td>
      <td>0.986</td>
      <td>0.0527</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>3</td>
      <td>&lt;NA&gt;</td>
      <td>0.0152</td>
      <td>interpolated</td>
      <td>0.0152</td>
      <td>0.0152</td>
      <td>0.0152</td>
      <td>interpolated</td>
      <td>1.88</td>
      <td>1</td>
      <td>0</td>
      <td>0.982</td>
      <td>0.0597</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>average</td>
      <td>3</td>
      <td>0.017</td>
      <td>interpolated</td>
      <td>0.017</td>
      <td>0.017</td>
      <td>0.017</td>
      <td>interpolated</td>
      <td>2.28</td>
      <td>1</td>
      <td>0</td>
      <td>0.992</td>
      <td>0.0389</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FI6v3</td>
      <td>K(-8T)</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>0.0308</td>
      <td>interpolated</td>
      <td>0.0308</td>
      <td>0.0308</td>
      <td>0.0308</td>
      <td>interpolated</td>
      <td>2.62</td>
      <td>1</td>
      <td>0</td>
      <td>0.977</td>
      <td>0.077</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The “average” is the curve fit to the average of the data points, not the average of the fit parameters for individual curves.</p>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">no_average</span></code> to not show the average:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">fitParams</span><span class="p">(</span><span class="n">average_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">no_average</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>serum</th>
      <th>virus</th>
      <th>replicate</th>
      <th>nreplicates</th>
      <th>ic50</th>
      <th>ic50_bound</th>
      <th>ic50_str</th>
      <th>midpoint</th>
      <th>midpoint_bound</th>
      <th>midpoint_bound_type</th>
      <th>slope</th>
      <th>top</th>
      <th>bottom</th>
      <th>r2</th>
      <th>rmsd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>0.0167</td>
      <td>interpolated</td>
      <td>0.0167</td>
      <td>0.0167</td>
      <td>0.0167</td>
      <td>interpolated</td>
      <td>2.5</td>
      <td>1</td>
      <td>0</td>
      <td>0.996</td>
      <td>0.0284</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>0.019</td>
      <td>interpolated</td>
      <td>0.019</td>
      <td>0.019</td>
      <td>0.019</td>
      <td>interpolated</td>
      <td>2.51</td>
      <td>1</td>
      <td>0</td>
      <td>0.986</td>
      <td>0.0527</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>3</td>
      <td>&lt;NA&gt;</td>
      <td>0.0152</td>
      <td>interpolated</td>
      <td>0.0152</td>
      <td>0.0152</td>
      <td>0.0152</td>
      <td>interpolated</td>
      <td>1.88</td>
      <td>1</td>
      <td>0</td>
      <td>0.982</td>
      <td>0.0597</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FI6v3</td>
      <td>K(-8T)</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>0.0308</td>
      <td>interpolated</td>
      <td>0.0308</td>
      <td>0.0308</td>
      <td>0.0308</td>
      <td>interpolated</td>
      <td>2.62</td>
      <td>1</td>
      <td>0</td>
      <td>0.977</td>
      <td>0.077</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FI6v3</td>
      <td>K(-8T)</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>0.0284</td>
      <td>interpolated</td>
      <td>0.0284</td>
      <td>0.0284</td>
      <td>0.0284</td>
      <td>interpolated</td>
      <td>2.55</td>
      <td>1</td>
      <td>0</td>
      <td>0.986</td>
      <td>0.0601</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We can also include arbitrary inhibitory concentrations, such as the IC95 in addition to the IC50 via the argument to<code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.fitParams()</span></code>. For instance:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">fitParams</span><span class="p">(</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">95</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>serum</th>
      <th>virus</th>
      <th>replicate</th>
      <th>nreplicates</th>
      <th>ic50</th>
      <th>ic50_bound</th>
      <th>ic50_str</th>
      <th>ic95</th>
      <th>ic95_bound</th>
      <th>ic95_str</th>
      <th>midpoint</th>
      <th>midpoint_bound</th>
      <th>midpoint_bound_type</th>
      <th>slope</th>
      <th>top</th>
      <th>bottom</th>
      <th>r2</th>
      <th>rmsd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>average</td>
      <td>3</td>
      <td>0.017</td>
      <td>interpolated</td>
      <td>0.017</td>
      <td>0.062</td>
      <td>interpolated</td>
      <td>0.062</td>
      <td>0.017</td>
      <td>0.017</td>
      <td>interpolated</td>
      <td>2.28</td>
      <td>1</td>
      <td>0</td>
      <td>0.992</td>
      <td>0.0389</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FI6v3</td>
      <td>K(-8T)</td>
      <td>average</td>
      <td>3</td>
      <td>0.0283</td>
      <td>interpolated</td>
      <td>0.0283</td>
      <td>0.0967</td>
      <td>interpolated</td>
      <td>0.0967</td>
      <td>0.0283</td>
      <td>0.0283</td>
      <td>interpolated</td>
      <td>2.4</td>
      <td>1</td>
      <td>0</td>
      <td>0.986</td>
      <td>0.0592</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FI6v3</td>
      <td>P80D</td>
      <td>average</td>
      <td>3</td>
      <td>0.0123</td>
      <td>interpolated</td>
      <td>0.0123</td>
      <td>0.0516</td>
      <td>interpolated</td>
      <td>0.0516</td>
      <td>0.0123</td>
      <td>0.0123</td>
      <td>interpolated</td>
      <td>2.05</td>
      <td>1</td>
      <td>0</td>
      <td>0.99</td>
      <td>0.0467</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FI6v3</td>
      <td>V135T</td>
      <td>average</td>
      <td>3</td>
      <td>0.0229</td>
      <td>interpolated</td>
      <td>0.0229</td>
      <td>0.114</td>
      <td>interpolated</td>
      <td>0.114</td>
      <td>0.0229</td>
      <td>0.0229</td>
      <td>interpolated</td>
      <td>1.83</td>
      <td>1</td>
      <td>0</td>
      <td>0.995</td>
      <td>0.0328</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FI6v3</td>
      <td>K280A</td>
      <td>average</td>
      <td>3</td>
      <td>0.0106</td>
      <td>interpolated</td>
      <td>0.0106</td>
      <td>0.0516</td>
      <td>interpolated</td>
      <td>0.0516</td>
      <td>0.0106</td>
      <td>0.0106</td>
      <td>interpolated</td>
      <td>1.86</td>
      <td>1</td>
      <td>0</td>
      <td>0.981</td>
      <td>0.0655</td>
    </tr>
    <tr>
      <th>5</th>
      <td>FI6v3</td>
      <td>K280S</td>
      <td>average</td>
      <td>3</td>
      <td>0.0428</td>
      <td>interpolated</td>
      <td>0.0428</td>
      <td>0.186</td>
      <td>interpolated</td>
      <td>0.186</td>
      <td>0.0428</td>
      <td>0.0428</td>
      <td>interpolated</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0.993</td>
      <td>0.0376</td>
    </tr>
    <tr>
      <th>6</th>
      <td>FI6v3</td>
      <td>K280T</td>
      <td>average</td>
      <td>3</td>
      <td>0.0348</td>
      <td>interpolated</td>
      <td>0.0348</td>
      <td>0.176</td>
      <td>interpolated</td>
      <td>0.176</td>
      <td>0.0348</td>
      <td>0.0348</td>
      <td>interpolated</td>
      <td>1.82</td>
      <td>1</td>
      <td>0</td>
      <td>0.993</td>
      <td>0.0375</td>
    </tr>
    <tr>
      <th>7</th>
      <td>FI6v3</td>
      <td>N291S</td>
      <td>average</td>
      <td>3</td>
      <td>0.0845</td>
      <td>interpolated</td>
      <td>0.0845</td>
      <td>0.433</td>
      <td>interpolated</td>
      <td>0.433</td>
      <td>0.0845</td>
      <td>0.0845</td>
      <td>interpolated</td>
      <td>1.8</td>
      <td>1</td>
      <td>0</td>
      <td>0.997</td>
      <td>0.0228</td>
    </tr>
    <tr>
      <th>8</th>
      <td>FI6v3</td>
      <td>M17L-HA2</td>
      <td>average</td>
      <td>3</td>
      <td>0.0198</td>
      <td>interpolated</td>
      <td>0.0198</td>
      <td>0.083</td>
      <td>interpolated</td>
      <td>0.083</td>
      <td>0.0198</td>
      <td>0.0198</td>
      <td>interpolated</td>
      <td>2.06</td>
      <td>1</td>
      <td>0</td>
      <td>0.989</td>
      <td>0.0483</td>
    </tr>
    <tr>
      <th>9</th>
      <td>FI6v3</td>
      <td>G47R-HA2</td>
      <td>average</td>
      <td>3</td>
      <td>0.0348</td>
      <td>interpolated</td>
      <td>0.0348</td>
      <td>0.108</td>
      <td>interpolated</td>
      <td>0.108</td>
      <td>0.0348</td>
      <td>0.0348</td>
      <td>interpolated</td>
      <td>2.6</td>
      <td>1</td>
      <td>0</td>
      <td>0.982</td>
      <td>0.0674</td>
    </tr>
    <tr>
      <th>10</th>
      <td>H17-L19</td>
      <td>WT</td>
      <td>average</td>
      <td>2</td>
      <td>0.106</td>
      <td>interpolated</td>
      <td>0.106</td>
      <td>0.221</td>
      <td>interpolated</td>
      <td>0.221</td>
      <td>0.106</td>
      <td>0.106</td>
      <td>interpolated</td>
      <td>4.04</td>
      <td>1</td>
      <td>0</td>
      <td>0.99</td>
      <td>0.0518</td>
    </tr>
    <tr>
      <th>11</th>
      <td>H17-L19</td>
      <td>V135T</td>
      <td>average</td>
      <td>2</td>
      <td>11.4</td>
      <td>lower</td>
      <td>&gt;11.4</td>
      <td>11.4</td>
      <td>lower</td>
      <td>&gt;11.4</td>
      <td>16.9</td>
      <td>11.4</td>
      <td>lower</td>
      <td>2.36</td>
      <td>1</td>
      <td>0</td>
      <td>0.708</td>
      <td>0.052</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Include standard deviations on IC50s calculated from estimated errors on parameters during fitting. Note that although this method is implemented, we <strong>strongly</strong> recommend instead fitting each replicate separately and computing errors that way instead (see immediately below):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">fitParams</span><span class="p">(</span><span class="n">ic50_error</span><span class="o">=</span><span class="s2">&quot;fit_stdev&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>serum</th>
      <th>virus</th>
      <th>replicate</th>
      <th>nreplicates</th>
      <th>ic50</th>
      <th>ic50_bound</th>
      <th>ic50_str</th>
      <th>ic50_error</th>
      <th>midpoint</th>
      <th>midpoint_bound</th>
      <th>midpoint_bound_type</th>
      <th>slope</th>
      <th>top</th>
      <th>bottom</th>
      <th>r2</th>
      <th>rmsd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>average</td>
      <td>3</td>
      <td>0.017</td>
      <td>interpolated</td>
      <td>0.017</td>
      <td>0.0254</td>
      <td>0.017</td>
      <td>0.017</td>
      <td>interpolated</td>
      <td>2.28</td>
      <td>1</td>
      <td>0</td>
      <td>0.992</td>
      <td>0.0389</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FI6v3</td>
      <td>K(-8T)</td>
      <td>average</td>
      <td>3</td>
      <td>0.0283</td>
      <td>interpolated</td>
      <td>0.0283</td>
      <td>0.0411</td>
      <td>0.0283</td>
      <td>0.0283</td>
      <td>interpolated</td>
      <td>2.4</td>
      <td>1</td>
      <td>0</td>
      <td>0.986</td>
      <td>0.0592</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FI6v3</td>
      <td>P80D</td>
      <td>average</td>
      <td>3</td>
      <td>0.0123</td>
      <td>interpolated</td>
      <td>0.0123</td>
      <td>0.0193</td>
      <td>0.0123</td>
      <td>0.0123</td>
      <td>interpolated</td>
      <td>2.05</td>
      <td>1</td>
      <td>0</td>
      <td>0.99</td>
      <td>0.0467</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FI6v3</td>
      <td>V135T</td>
      <td>average</td>
      <td>3</td>
      <td>0.0229</td>
      <td>interpolated</td>
      <td>0.0229</td>
      <td>0.0382</td>
      <td>0.0229</td>
      <td>0.0229</td>
      <td>interpolated</td>
      <td>1.83</td>
      <td>1</td>
      <td>0</td>
      <td>0.995</td>
      <td>0.0328</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FI6v3</td>
      <td>K280A</td>
      <td>average</td>
      <td>3</td>
      <td>0.0106</td>
      <td>interpolated</td>
      <td>0.0106</td>
      <td>0.0176</td>
      <td>0.0106</td>
      <td>0.0106</td>
      <td>interpolated</td>
      <td>1.86</td>
      <td>1</td>
      <td>0</td>
      <td>0.981</td>
      <td>0.0655</td>
    </tr>
    <tr>
      <th>5</th>
      <td>FI6v3</td>
      <td>K280S</td>
      <td>average</td>
      <td>3</td>
      <td>0.0428</td>
      <td>interpolated</td>
      <td>0.0428</td>
      <td>0.0683</td>
      <td>0.0428</td>
      <td>0.0428</td>
      <td>interpolated</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0.993</td>
      <td>0.0376</td>
    </tr>
    <tr>
      <th>6</th>
      <td>FI6v3</td>
      <td>K280T</td>
      <td>average</td>
      <td>3</td>
      <td>0.0348</td>
      <td>interpolated</td>
      <td>0.0348</td>
      <td>0.0582</td>
      <td>0.0348</td>
      <td>0.0348</td>
      <td>interpolated</td>
      <td>1.82</td>
      <td>1</td>
      <td>0</td>
      <td>0.993</td>
      <td>0.0375</td>
    </tr>
    <tr>
      <th>7</th>
      <td>FI6v3</td>
      <td>N291S</td>
      <td>average</td>
      <td>3</td>
      <td>0.0845</td>
      <td>interpolated</td>
      <td>0.0845</td>
      <td>0.142</td>
      <td>0.0845</td>
      <td>0.0845</td>
      <td>interpolated</td>
      <td>1.8</td>
      <td>1</td>
      <td>0</td>
      <td>0.997</td>
      <td>0.0228</td>
    </tr>
    <tr>
      <th>8</th>
      <td>FI6v3</td>
      <td>M17L-HA2</td>
      <td>average</td>
      <td>3</td>
      <td>0.0198</td>
      <td>interpolated</td>
      <td>0.0198</td>
      <td>0.0313</td>
      <td>0.0198</td>
      <td>0.0198</td>
      <td>interpolated</td>
      <td>2.06</td>
      <td>1</td>
      <td>0</td>
      <td>0.989</td>
      <td>0.0483</td>
    </tr>
    <tr>
      <th>9</th>
      <td>FI6v3</td>
      <td>G47R-HA2</td>
      <td>average</td>
      <td>3</td>
      <td>0.0348</td>
      <td>interpolated</td>
      <td>0.0348</td>
      <td>0.0477</td>
      <td>0.0348</td>
      <td>0.0348</td>
      <td>interpolated</td>
      <td>2.6</td>
      <td>1</td>
      <td>0</td>
      <td>0.982</td>
      <td>0.0674</td>
    </tr>
    <tr>
      <th>10</th>
      <td>H17-L19</td>
      <td>WT</td>
      <td>average</td>
      <td>2</td>
      <td>0.106</td>
      <td>interpolated</td>
      <td>0.106</td>
      <td>0.144</td>
      <td>0.106</td>
      <td>0.106</td>
      <td>interpolated</td>
      <td>4.04</td>
      <td>1</td>
      <td>0</td>
      <td>0.99</td>
      <td>0.0518</td>
    </tr>
    <tr>
      <th>11</th>
      <td>H17-L19</td>
      <td>V135T</td>
      <td>average</td>
      <td>2</td>
      <td>11.4</td>
      <td>lower</td>
      <td>&gt;11.4</td>
      <td>NaN</td>
      <td>16.9</td>
      <td>11.4</td>
      <td>lower</td>
      <td>2.36</td>
      <td>1</td>
      <td>0</td>
      <td>0.708</td>
      <td>0.052</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Here is the recommended way to get error estimates by just taking the average of fits for each replicate:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params_avg_fit</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">fitParams</span><span class="p">()[</span>
    <span class="p">[</span><span class="s2">&quot;serum&quot;</span><span class="p">,</span> <span class="s2">&quot;virus&quot;</span><span class="p">,</span> <span class="s2">&quot;ic50&quot;</span><span class="p">,</span> <span class="s2">&quot;ic50_bound&quot;</span><span class="p">,</span> <span class="s2">&quot;nreplicates&quot;</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">params_avg_reps</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">fitParams</span><span class="p">(</span><span class="n">average_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;replicate != &quot;average&quot;&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;serum&quot;</span><span class="p">,</span> <span class="s2">&quot;virus&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
        <span class="n">ic50_replicate_avg</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="s2">&quot;ic50&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">),</span>
        <span class="n">ic50_replicate_stderr</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="s2">&quot;ic50&quot;</span><span class="p">,</span> <span class="s2">&quot;sem&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">params_avg_fit</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">params_avg_reps</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;serum&quot;</span><span class="p">,</span> <span class="s2">&quot;virus&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>serum</th>
      <th>virus</th>
      <th>ic50</th>
      <th>ic50_bound</th>
      <th>nreplicates</th>
      <th>ic50_replicate_avg</th>
      <th>ic50_replicate_stderr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FI6v3</td>
      <td>WT</td>
      <td>0.017</td>
      <td>interpolated</td>
      <td>3</td>
      <td>0.017</td>
      <td>0.00112</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FI6v3</td>
      <td>K(-8T)</td>
      <td>0.0283</td>
      <td>interpolated</td>
      <td>3</td>
      <td>0.0283</td>
      <td>0.0015</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FI6v3</td>
      <td>P80D</td>
      <td>0.0123</td>
      <td>interpolated</td>
      <td>3</td>
      <td>0.0123</td>
      <td>0.000271</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FI6v3</td>
      <td>V135T</td>
      <td>0.0229</td>
      <td>interpolated</td>
      <td>3</td>
      <td>0.0229</td>
      <td>0.000201</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FI6v3</td>
      <td>K280A</td>
      <td>0.0106</td>
      <td>interpolated</td>
      <td>3</td>
      <td>0.0106</td>
      <td>0.000819</td>
    </tr>
    <tr>
      <th>5</th>
      <td>FI6v3</td>
      <td>K280S</td>
      <td>0.0428</td>
      <td>interpolated</td>
      <td>3</td>
      <td>0.0428</td>
      <td>0.000821</td>
    </tr>
    <tr>
      <th>6</th>
      <td>FI6v3</td>
      <td>K280T</td>
      <td>0.0348</td>
      <td>interpolated</td>
      <td>3</td>
      <td>0.0349</td>
      <td>0.00155</td>
    </tr>
    <tr>
      <th>7</th>
      <td>FI6v3</td>
      <td>N291S</td>
      <td>0.0845</td>
      <td>interpolated</td>
      <td>3</td>
      <td>0.0844</td>
      <td>0.00448</td>
    </tr>
    <tr>
      <th>8</th>
      <td>FI6v3</td>
      <td>M17L-HA2</td>
      <td>0.0198</td>
      <td>interpolated</td>
      <td>3</td>
      <td>0.0197</td>
      <td>0.000986</td>
    </tr>
    <tr>
      <th>9</th>
      <td>FI6v3</td>
      <td>G47R-HA2</td>
      <td>0.0348</td>
      <td>interpolated</td>
      <td>3</td>
      <td>0.0347</td>
      <td>0.000766</td>
    </tr>
    <tr>
      <th>10</th>
      <td>H17-L19</td>
      <td>WT</td>
      <td>0.106</td>
      <td>interpolated</td>
      <td>2</td>
      <td>0.107</td>
      <td>0.012</td>
    </tr>
    <tr>
      <th>11</th>
      <td>H17-L19</td>
      <td>V135T</td>
      <td>11.4</td>
      <td>lower</td>
      <td>2</td>
      <td>11.4</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Plotting-the-curves">
<h2>Plotting the curves<a class="headerlink" href="#Plotting-the-curves" title="Link to this heading">¶</a></h2>
<p>One of the most useful feature of <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits</span></code> are that they have methods to easily generate multi-panel plots of the curves.</p>
<section id="Plotting-each-serum-against-multiple-viruses">
<h3>Plotting each serum against multiple viruses<a class="headerlink" href="#Plotting-each-serum-against-multiple-viruses" title="Link to this heading">¶</a></h3>
<p>Often you will have measured each serum against several different viral variants. You can then plot these curves using <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotSera()</span></code> as below:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotSera</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_36_0.png" src="_images/curvefits_example_36_0.png" />
</div>
</div>
<p>The above plot attempts to put all the viruses measured against each serum on the same subplot, but is cognizant of the fact that it becomes uninterpretable if there are too many viruses on the same plot. Therefore, it only shows a maximum of (which by default is 5) curves per subplot.</p>
<p>In fact, that is still perhaps too many curves per plot for this data set. So we can customize the plot by adjusting that parameter. Below we adjust to just four viruses per subplot, and also use to specify that we want two columns:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotSera</span><span class="p">(</span>
    <span class="n">max_viruses_per_subplot</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_38_0.png" src="_images/curvefits_example_38_0.png" />
</div>
</div>
<p>And here is plotting only the line in bounds of the data points using <code class="docutils literal notranslate"><span class="pre">draw_in_bounds=True</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotSera</span><span class="p">(</span>
    <span class="n">max_viruses_per_subplot</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">,</span>
    <span class="n">draw_in_bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_40_0.png" src="_images/curvefits_example_40_0.png" />
</div>
</div>
<p>The above plots all have a different legend for each subplot. This is necessary because the number of different viruses being plotted exceeds the numbers of colors / markers specified to <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotSera()</span></code> via its and arguments, so there aren’t enough colors / markers to give each virus a unique one.</p>
<p>However, if we reduce the number of viruses we are showing, we then get a nice shared legend. Here we do this, using the argument to specify that we just show some of the viruses:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotSera</span><span class="p">(</span>
    <span class="n">viruses</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;WT&quot;</span><span class="p">,</span> <span class="s2">&quot;N291S&quot;</span><span class="p">,</span> <span class="s2">&quot;K280S&quot;</span><span class="p">,</span> <span class="s2">&quot;V135T&quot;</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_42_0.png" src="_images/curvefits_example_42_0.png" />
</div>
</div>
<p>Similar to how the above plot uses the argument to plot just some viruses, we can also use the argument to plot just some of the sera (in this case, just H17-L19):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotSera</span><span class="p">(</span><span class="n">sera</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;H17-L19&quot;</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_44_0.png" src="_images/curvefits_example_44_0.png" />
</div>
</div>
<p>We can also use the argument to specify a particular color scheme:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotSera</span><span class="p">(</span>
    <span class="n">viruses</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;WT&quot;</span><span class="p">,</span> <span class="s2">&quot;N291S&quot;</span><span class="p">,</span> <span class="s2">&quot;K280S&quot;</span><span class="p">],</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">,</span>
    <span class="n">virus_to_color_marker</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;WT&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">),</span>
        <span class="s2">&quot;N291S&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="s2">&quot;^&quot;</span><span class="p">),</span>
        <span class="s2">&quot;K280S&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="n">legendfontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_46_0.png" src="_images/curvefits_example_46_0.png" />
</div>
</div>
<p>There are various additional options to <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotSera()</span></code> that can further fine-tune the plots; see the docstring for that method for more details.</p>
</section>
<section id="Plotting-each-virus-against-multiple-sera">
<h3>Plotting each virus against multiple sera<a class="headerlink" href="#Plotting-each-virus-against-multiple-sera" title="Link to this heading">¶</a></h3>
<p>It is also possible to plot each virus against multiple sera using <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotViruses()</span></code> as below:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotViruses</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_48_0.png" src="_images/curvefits_example_48_0.png" />
</div>
</div>
<p>We can also make the plot for just certain viruses:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotViruses</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">,</span>
    <span class="n">viruses</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;WT&quot;</span><span class="p">,</span> <span class="s2">&quot;V135T&quot;</span><span class="p">],</span>
    <span class="n">serum_to_color_marker</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;FI6v3&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">),</span> <span class="s2">&quot;H17-L19&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">)},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_50_0.png" src="_images/curvefits_example_50_0.png" />
</div>
</div>
<p>and also for just certain sera:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotViruses</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">,</span> <span class="n">viruses</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;WT&quot;</span><span class="p">,</span> <span class="s2">&quot;V135T&quot;</span><span class="p">],</span> <span class="n">sera</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;H17-L19&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_52_0.png" src="_images/curvefits_example_52_0.png" />
</div>
</div>
</section>
<section id="Plotting-each-replicate">
<h3>Plotting each replicate<a class="headerlink" href="#Plotting-each-replicate" title="Link to this heading">¶</a></h3>
<p>Another type of plot that is sometimes useful is one that shows all the replicates for each serum / virus combination. Such a plot is easily generated using <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotReplicates()</span></code> as below:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotReplicates</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">,</span> <span class="n">legendtitle</span><span class="o">=</span><span class="s2">&quot;replicate&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_54_0.png" src="_images/curvefits_example_54_0.png" />
</div>
</div>
<p>If you do not want to share the legend across panesl, use <code class="docutils literal notranslate"><span class="pre">attempt_shared_legend=False</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotReplicates</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">,</span>
    <span class="n">legendtitle</span><span class="o">=</span><span class="s2">&quot;replicate&quot;</span><span class="p">,</span>
    <span class="n">attempt_shared_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_56_0.png" src="_images/curvefits_example_56_0.png" />
</div>
</div>
<p>See the method docstring for <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotReplicates()</span></code> for ways to further customize these plots.</p>
</section>
<section id="Plotting-average-for-each-serum-virus-pair">
<h3>Plotting average for each serum-virus pair<a class="headerlink" href="#Plotting-average-for-each-serum-virus-pair" title="Link to this heading">¶</a></h3>
<p>Another type of plot that is useful is one that simply shows the replicate-average for each serum-virus pair on its own subplot. This plot can be generated with <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotAverages()</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotAverages</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_58_0.png" src="_images/curvefits_example_58_0.png" />
</div>
</div>
</section>
<section id="Customized-plot-arrangements">
<h3>Customized plot arrangements<a class="headerlink" href="#Customized-plot-arrangements" title="Link to this heading">¶</a></h3>
<p>There are obviously many other ways that it’s possible to lay out the different curves for sera / viruses / replicates on subplots. You can make an arbitrarily customized layout using <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotGrid()</span></code> where you explicitly pass the curves to put at each subplot in the plot.</p>
<p>Below we illustrate how to do this to create a plot that essentially mimics what is shown in <a class="reference external" href="https://www.nature.com/articles/s41467-018-03665-3#Fig6">Fig 6a,b of Doud et al (2018)</a> (although those published plots were not generated using this program). Note that in doing this below, we use the colors and markers defined by and in <code class="docutils literal notranslate"><span class="pre">neutcurve.colorschemes</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotGrid</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="c1"># upper right: FI6v3 versus WT, K280S, K280T, K280A</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="p">(</span>
            <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;WT&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;WT&quot;</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;K280S&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;K280S&quot;</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;K280T&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;K280T&quot;</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;K280A&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;K280A&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">],</span>
        <span class="p">),</span>
        <span class="c1"># upper center: FI6v3 versus WT, N291S</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="p">(</span>
            <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;WT&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;WT&quot;</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;N291S&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;N291S&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">],</span>
        <span class="p">),</span>
        <span class="c1"># upper right: FI6v3 versus WT, G47R-HA2</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="p">(</span>
            <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;WT&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;WT&quot;</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;G47R-HA2&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;G47R(HA2)&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">],</span>
        <span class="p">),</span>
        <span class="c1"># middle right: FI6v3 versus WT, K(-8T)</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="p">(</span>
            <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;WT&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;WT&quot;</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;K(-8T)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;K(-8T)&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">],</span>
        <span class="p">),</span>
        <span class="c1"># middle center: FI6v3 versus WT, M17L-HA2</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="p">(</span>
            <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;WT&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;WT&quot;</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;M17L-HA2&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;M17L(HA2)&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">],</span>
        <span class="p">),</span>
        <span class="c1"># middle right: FI6v3 versus WT, P80D, V135T</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="p">(</span>
            <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;WT&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;WT&quot;</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;P80D&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;P80D&quot;</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;FI6v3&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;V135T&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;V135T&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">],</span>
        <span class="p">),</span>
        <span class="c1"># middle left: H17-L19 versus WT, V135T</span>
        <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="p">(</span>
            <span class="s2">&quot;H17-L19&quot;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;H17-L19&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;WT&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;WT&quot;</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;H17-L19&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;V135T&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="n">CBMARKERS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;V135T&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">],</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_60_0.png" src="_images/curvefits_example_60_0.png" />
</div>
</div>
<p>Fitting some problematic curves</p>
<p>Here we demonstrate that the method can also fit a problematic HIV curve that never reaches the IC50.</p>
<p>Data frame with data for virus not neutralized at any concentration:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hiv_neut_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;BF520.1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;H330R&quot;</span><span class="p">,</span>
                <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;concentration&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mf">0.020576132</span><span class="p">,</span>
                    <span class="mf">0.061728395</span><span class="p">,</span>
                    <span class="mf">0.185185185</span><span class="p">,</span>
                    <span class="mf">0.555555556</span><span class="p">,</span>
                    <span class="mf">1.666666667</span><span class="p">,</span>
                    <span class="mi">5</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="s2">&quot;fraction infectivity&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mf">0.721440083</span><span class="p">,</span>
                    <span class="mf">0.882537173</span><span class="p">,</span>
                    <span class="mf">1.01964302</span><span class="p">,</span>
                    <span class="mf">0.904916836</span><span class="p">,</span>
                    <span class="mf">0.870465533</span><span class="p">,</span>
                    <span class="mf">0.866026089</span><span class="p">,</span>
                <span class="p">],</span>
            <span class="p">}</span>
        <span class="p">),</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;serum&quot;</span><span class="p">:</span> <span class="s2">&quot;BF520.1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;virus&quot;</span><span class="p">:</span> <span class="s2">&quot;H330R&quot;</span><span class="p">,</span>
                <span class="s2">&quot;replicate&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;concentration&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mf">0.020576132</span><span class="p">,</span>
                    <span class="mf">0.061728395</span><span class="p">,</span>
                    <span class="mf">0.185185185</span><span class="p">,</span>
                    <span class="mf">0.555555556</span><span class="p">,</span>
                    <span class="mf">1.666666667</span><span class="p">,</span>
                    <span class="mi">5</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="s2">&quot;fraction infectivity&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mf">0.857961054</span><span class="p">,</span>
                    <span class="mf">0.973908617</span><span class="p">,</span>
                    <span class="mf">1.04569174</span><span class="p">,</span>
                    <span class="mf">1.007668321</span><span class="p">,</span>
                    <span class="mf">0.959208349</span><span class="p">,</span>
                    <span class="mf">1.046646303</span><span class="p">,</span>
                <span class="p">],</span>
            <span class="p">}</span>
        <span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">hiv_neut_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>serum</th>
      <th>virus</th>
      <th>replicate</th>
      <th>concentration</th>
      <th>fraction infectivity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BF520.1</td>
      <td>H330R</td>
      <td>1</td>
      <td>0.0206</td>
      <td>0.721</td>
    </tr>
    <tr>
      <th>1</th>
      <td>BF520.1</td>
      <td>H330R</td>
      <td>1</td>
      <td>0.0617</td>
      <td>0.883</td>
    </tr>
    <tr>
      <th>2</th>
      <td>BF520.1</td>
      <td>H330R</td>
      <td>1</td>
      <td>0.185</td>
      <td>1.02</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BF520.1</td>
      <td>H330R</td>
      <td>1</td>
      <td>0.556</td>
      <td>0.905</td>
    </tr>
    <tr>
      <th>4</th>
      <td>BF520.1</td>
      <td>H330R</td>
      <td>1</td>
      <td>1.67</td>
      <td>0.87</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Fit and plot curve:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hiv_fit</span> <span class="o">=</span> <span class="n">neutcurve</span><span class="o">.</span><span class="n">CurveFits</span><span class="p">(</span><span class="n">hiv_neut_data</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">hiv_fit</span><span class="o">.</span><span class="n">plotSera</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_64_0.png" src="_images/curvefits_example_64_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hiv_fit</span><span class="o">.</span><span class="n">fitParams</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>serum</th>
      <th>virus</th>
      <th>replicate</th>
      <th>nreplicates</th>
      <th>ic50</th>
      <th>ic50_bound</th>
      <th>ic50_str</th>
      <th>midpoint</th>
      <th>midpoint_bound</th>
      <th>midpoint_bound_type</th>
      <th>slope</th>
      <th>top</th>
      <th>bottom</th>
      <th>r2</th>
      <th>rmsd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BF520.1</td>
      <td>H330R</td>
      <td>average</td>
      <td>2</td>
      <td>5</td>
      <td>lower</td>
      <td>&gt;5</td>
      <td>1.63e+04</td>
      <td>5</td>
      <td>lower</td>
      <td>3.56</td>
      <td>1</td>
      <td>0</td>
      <td>-0.932</td>
      <td>0.101</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Drawing-vertical-lines">
<h3>Drawing vertical lines<a class="headerlink" href="#Drawing-vertical-lines" title="Link to this heading">¶</a></h3>
<p>It can sometimes be useful to draw vertical lines on the plot, such as to indicate concentrations used for selection experiments. This can be done in a highly customized way using the option to <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits.plotSera()</span></code> as in the example below:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotSera</span><span class="p">(</span>
    <span class="n">max_viruses_per_subplot</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">nrow</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ncol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">,</span>
    <span class="n">vlines</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;FI6v3&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;magenta&quot;</span><span class="p">}],</span>
        <span class="s2">&quot;H17-L19&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;linestyle&quot;</span><span class="p">:</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">}],</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_67_0.png" src="_images/curvefits_example_67_0.png" />
</div>
</div>
</section>
<section id="Additional-plot-customization">
<h3>Additional plot customization<a class="headerlink" href="#Additional-plot-customization" title="Link to this heading">¶</a></h3>
<p>The plots are returned as figures / axes, so can be customized just like any other generated plot. For instance, to customize axis ticks and labels, you can do the below:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig2</span><span class="p">,</span> <span class="n">axes2</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">plotSera</span><span class="p">(</span>
    <span class="n">max_viruses_per_subplot</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">nrow</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ncol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;log10 concentration (ug/ml)&quot;</span><span class="p">,</span>
    <span class="n">vlines</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;FI6v3&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;magenta&quot;</span><span class="p">}],</span>
        <span class="s2">&quot;H17-L19&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;linestyle&quot;</span><span class="p">:</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">}],</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">axes2</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">axes2</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s2">&quot;-3&quot;</span><span class="p">,</span> <span class="s2">&quot;-2&quot;</span><span class="p">,</span> <span class="s2">&quot;-1&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/curvefits_example_69_0.png" src="_images/curvefits_example_69_0.png" />
</div>
</div>
<p>This assumes the plotting was done using <code class="docutils literal notranslate"><span class="pre">sharex=True</span></code> and <code class="docutils literal notranslate"><span class="pre">sharey=True</span></code> (on by default), which makes all axes share the same x-ticks so they can be set for just the last plot. Otherwise you need to set the ticks for each axis separately.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/BloomLogo.jpg" alt="Logo" />
    
    <h1 class="logo logo-name">neutcurve</h1>
    
  </a>
</p>



<p class="blurb">Fit and plot neutralization curves</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jbloomlab&repo=neutcurve&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">neutcurve documentation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="hillcurve_example.html">Hill-curve neutralization</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Fitting curves to real data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Importing-Python-packages">Importing Python packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Preparing-the-data">Preparing the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Fitting-the-curves">Fitting the curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Looking-at-a-specific-curve">Looking at a specific curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Accessing-the-fit-parameters-for-all-curves">Accessing the fit parameters for all curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Plotting-the-curves">Plotting the curves</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="constrain_params_range.html">Constrain fit parameters to a range of reasonable values</a></li>
<li class="toctree-l1"><a class="reference internal" href="combine_curvefits.html">Combining <code class="docutils literal notranslate"><span class="pre">CurveFits</span></code> objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_curves.html">Test curve fitting on some real data</a></li>
<li class="toctree-l1"><a class="reference internal" href="neutcurve.html">neutcurve package</a></li>
<li class="toctree-l1"><a class="reference internal" href="package_index.html">package index</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgements</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="hillcurve_example.html" title="previous chapter">Hill-curve neutralization</a></li>
      <li>Next: <a href="constrain_params_range.html" title="next chapter">Constrain fit parameters to a range of reasonable values</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2019--2024, Bloom lab.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/curvefits_example.nblink.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/jbloomlab/neutcurve" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>