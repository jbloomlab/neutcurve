<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Hill-curve neutralization &#8212; neutcurve 2.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=c878986b" />
    <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="_static/documentation_options.js?v=20623aea"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Fitting curves to real data" href="curvefits_example.html" />
    <link rel="prev" title="Installation" href="installation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Hill-curve-neutralization">
<h1>Hill-curve neutralization<a class="headerlink" href="#Hill-curve-neutralization" title="Link to this heading">¶</a></h1>
<section id="Mathematical-form-of-curves">
<h2>Mathematical form of curves<a class="headerlink" href="#Mathematical-form-of-curves" title="Link to this heading">¶</a></h2>
<p>The neutralization curve is fit to measurements of the fraction infectivity remaining <span class="math notranslate nohighlight">\(f\left(c\right)\)</span> at several different serum concentrations <span class="math notranslate nohighlight">\(c\)</span>. The equation for the curve is:</p>
<div class="math notranslate nohighlight">
\[f(c) = b + \frac{t - b}{1 + (c/m)^s}\]</div>
<p>where <span class="math notranslate nohighlight">\(m\)</span> is the midpoint of the curve, <span class="math notranslate nohighlight">\(t\)</span> is the “top” of the curve, <span class="math notranslate nohighlight">\(b\)</span> is the bottom of the curve, and <span class="math notranslate nohighlight">\(s\)</span> is the “slope” or Hill coefficient of the curve.</p>
<p>If the curve spans from completely non-neutralized (100% infectivity remaining) to completely neutralized (0% infectivity remaining), then <span class="math notranslate nohighlight">\(t = 1\)</span> and <span class="math notranslate nohighlight">\(b = 0\)</span>. In this case, Equation (1) is identical to 1 minus the <a class="reference external" href="https://en.wikipedia.org/wiki/Hill_equation_(biochemistry)">Hill equation defined on Wikipedia</a>.</p>
<p>However, it will not always be the case that the top and bottom are at 1 and 0. The reason is that some antibodies and sera do not go to complete neutralization (see <a class="reference external" href="https://doi.org/10.1371/journal.ppat.1005110">here</a> for a discussion of the phenomenon for HIV). For such antibodies, <span class="math notranslate nohighlight">\(b\)</span> will in general be <span class="math notranslate nohighlight">\(&gt;0\)</span>. Therefore, in the fitting you have the option of constraining the top and bottom to <span class="math notranslate nohighlight">\(t = 1\)</span> and <span class="math notranslate nohighlight">\(b = 0\)</span>, or to fit them as free parameters. The default is to
constrain the top to <span class="math notranslate nohighlight">\(t = 1\)</span> and the bottom to <span class="math notranslate nohighlight">\(b = 0\)</span>, but you should look at your curves to ensure this makes sense–and if they don’t plateau at complete neutralization, set the bottom <span class="math notranslate nohighlight">\(b\)</span> to be a free parameter to allow for incomplete neutralization.</p>
<p>Since <span class="math notranslate nohighlight">\(f\left(c\right)\)</span> in Equation (1) is the fraction <strong>infectivity</strong>, we expect <span class="math notranslate nohighlight">\(f\left(c\right)\)</span> to get smaller as the antibody concentration increases. Just be aware that some papers will plot fraction neutralized rather than fraction infectivity; fraction neutralized is <span class="math notranslate nohighlight">\(1 - f\left(c\right)\)</span>. If your data is fraction neutralized, you should convert it to fraction infectivity before using this package, or use the option described in the docs for
<code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve</span></code>.</p>
</section>
<section id="Fitting-using-the-HillCurve-class">
<h2>Fitting using the HillCurve class<a class="headerlink" href="#Fitting-using-the-HillCurve-class" title="Link to this heading">¶</a></h2>
<p>The curves are fit using the <code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve</span></code> class. For fitting to actual data, you will typically want to fit these curves via <code class="docutils literal notranslate"><span class="pre">neutcurve.curvefits.CurveFits</span></code> as described in <em>Fitting curves to real data</em>, particularly when there are multiple samples being fit at once. Nonetheless, here we illustrate the basic fitting to a single sample using <code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve</span></code>.</p>
<p>First, we import the requisite Python modules:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">neutcurve</span>
</pre></div>
</div>
</div>
<p>Set pandas display options:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.float_format&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{:.5f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we get example data to plot. We use as our example the neutralization of wildtype (WT) A/WSN/1933 (H1N1) influenza by the broadly neutralizing antibody FI6v3 as determined in <a class="reference external" href="https://www.nature.com/articles/s41467-018-03665-3#Fig6">Fig 6a of Doud et al (2018)</a>. The numerical data in that figure in tidy form are available in a CSV file. We read the data and get just the measurements for replicate 1 of the wildtype virus against FI6v3:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fi6v3_datafile</span> <span class="o">=</span> <span class="s2">&quot;Doud_et_al_2018-neutdata.csv&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fi6v3_datafile</span><span class="p">)</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;(serum == &quot;FI6v3&quot;) &amp; (virus == &quot;WT&quot;) &amp; (replicate == 1)&#39;</span><span class="p">)[</span>
        <span class="p">[</span><span class="s2">&quot;concentration&quot;</span><span class="p">,</span> <span class="s2">&quot;fraction infectivity&quot;</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>concentration</th>
      <th>fraction infectivity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00020</td>
      <td>1.01373</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.00048</td>
      <td>0.94201</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.00112</td>
      <td>0.99285</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.00260</td>
      <td>0.96621</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.00607</td>
      <td>0.95670</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.01417</td>
      <td>0.58633</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.03305</td>
      <td>0.16945</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.07712</td>
      <td>0.01413</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.17995</td>
      <td>-0.02539</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.41989</td>
      <td>-0.03255</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.97974</td>
      <td>-0.03667</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2.28606</td>
      <td>-0.02877</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>As can be seen above, the data give the fraction activity at each antibody concentration (which in this case is in <span class="math notranslate nohighlight">\(\mu\)</span>g/ml).</p>
<p>Now we initialize a <code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve</span></code> with these data:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">curve</span> <span class="o">=</span> <span class="n">neutcurve</span><span class="o">.</span><span class="n">HillCurve</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;concentration&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fraction infectivity&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>We can now look at the values of each of the four fit parameters that define the curve:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;The top (t) is </span><span class="si">{</span><span class="n">curve</span><span class="o">.</span><span class="n">top</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;The bottom (b) is </span><span class="si">{</span><span class="n">curve</span><span class="o">.</span><span class="n">bottom</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;The midpoint (m) is </span><span class="si">{</span><span class="n">curve</span><span class="o">.</span><span class="n">midpoint</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;The slope (Hill coefficient)s is </span><span class="si">{</span><span class="n">curve</span><span class="o">.</span><span class="n">slope</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The top (t) is 1
The bottom (b) is 0
The midpoint (m) is 0.0167
The slope (Hill coefficient)s is 2.5
</pre></div></div>
</div>
<p>Note that the top and bottom are one and zero as they were constrained to those values. If you want to change whether the top and/or bottom are fixed or fit, you can do that using the and arguments to <code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve</span></code> as described in the docs for that class. For instance, below we fit the top and fix the bottom (it makes very little difference for this particular dataset):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">curve2</span> <span class="o">=</span> <span class="n">neutcurve</span><span class="o">.</span><span class="n">HillCurve</span><span class="p">(</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;concentration&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fraction infectivity&quot;</span><span class="p">],</span> <span class="n">fixtop</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;The top (t) is </span><span class="si">{</span><span class="n">curve2</span><span class="o">.</span><span class="n">top</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;The bottom (b) is </span><span class="si">{</span><span class="n">curve2</span><span class="o">.</span><span class="n">bottom</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;The midpoint (m) is </span><span class="si">{</span><span class="n">curve2</span><span class="o">.</span><span class="n">midpoint</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;The slope (Hill coefficient)s is </span><span class="si">{</span><span class="n">curve2</span><span class="o">.</span><span class="n">slope</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The top (t) is 0.987
The bottom (b) is 0
The midpoint (m) is 0.0169
The slope (Hill coefficient)s is 2.57
</pre></div></div>
</div>
<p>We can also get the IC50, which is the concentration where <span class="math notranslate nohighlight">\(f\left(c\right) = 0.5\)</span>. The IC50 will be equal to the midpoint <span class="math notranslate nohighlight">\(m\)</span> when the top (<span class="math notranslate nohighlight">\(t\)</span>) is one and the bottom (<span class="math notranslate nohighlight">\(b\)</span>) is zero, but otherwise it may be different than the IC50. For this particular dataset, the IC50 is very close to the midpoint:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The IC50 is </span><span class="si">{</span><span class="n">curve</span><span class="o">.</span><span class="n">ic50</span><span class="p">()</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The IC50 is 0.0167
</pre></div></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve.ic50()</span></code> has a option for how to handle computing the IC50 if it doesn’t fall within the range of the provided concentrations and so cannot be interpolated (see the docs for that method for details). This doesn’t matter for this particular dataset, however, since the IC50 falls within the range of the data. There are also two other methods that deal with IC50s that cannot be interpolated and so are only determinable as upper / lower bounds:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve.ic50_bound()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve.ic50_str()</span></code></p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">ic50_bound</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">ic50_str</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
interpolated
0.0167
</pre></div></div>
</div>
<p>We can generalize the IC50 using <code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve.icXX()</span></code>, which will compute the concentration at which an arbitrary fraction of virus is expected to be <strong>neutralized</strong> (note that this is fraction neutralized, which is one minus the fraction infectivity). For instance:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The IC95 is </span><span class="si">{</span><span class="n">curve</span><span class="o">.</span><span class="n">icXX</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The IC95 is 0.0541
</pre></div></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve.icXX()</span></code> has a argument that determines how we handle the case when the ICXX is outside of the range of measured concentrations, and that there are two other methods that deal with ICXXs that cannot be interpolated and are only determinable as upper / lower bounds:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve.icXX_bound()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve.icXX_str()</span></code></p></li>
</ul>
<p>We can plot the neutralization curve using the <code class="docutils literal notranslate"><span class="pre">neutcurve.hillcurve.HillCurve.plot()</span></code> function. This returns a matplotlib figure and axis instance:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/hillcurve_example_20_0.png" src="_images/hillcurve_example_20_0.png" />
</div>
</div>
<p>If you want to save the figure, do this using its <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.savefig.html">savefig</a> method, possibly calling <a class="reference external" href="https://matplotlib.org/users/tight_layout_guide.html">tight_layout</a> command first if there is clipping.</p>
<p>If you want to adjust the x-axis tick locations / labels, you can do it on the <code class="docutils literal notranslate"><span class="pre">ax</span></code> object returned as part of the plot:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s2">&quot;-3&quot;</span><span class="p">,</span> <span class="s2">&quot;-2&quot;</span><span class="p">,</span> <span class="s2">&quot;-1&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;log10 concentration&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/hillcurve_example_22_0.png" src="_images/hillcurve_example_22_0.png" />
</div>
</div>
<p>You can also plot the curve only in the bounds of the data using the <code class="docutils literal notranslate"><span class="pre">draw_in_bounds=True</span></code> option:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;concentration (ug/ml)&quot;</span><span class="p">,</span> <span class="n">draw_in_bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/hillcurve_example_24_0.png" src="_images/hillcurve_example_24_0.png" />
</div>
</div>
</section>
<section id="Quantifying-goodness-of-fit">
<h2>Quantifying goodness of fit<a class="headerlink" href="#Quantifying-goodness-of-fit" title="Link to this heading">¶</a></h2>
<p>We can quantify the goodness of fit by the <a class="reference external" href="https://en.wikipedia.org/wiki/Coefficient_of_determination">coefficient of determination</a> (<span class="math notranslate nohighlight">\(R^2\)</span>) using <code class="docutils literal notranslate"><span class="pre">HillCurve.r2</span></code>, which will be one if the curve perfectly fits the data and less than one otherwise. Essentially, this corresponds to the fraction of the variation in the data explained by the curve. A value of &lt;0 means the fit is worse than just drawing a straight line through the data:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">round</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">r2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.996
</pre></div></div>
</div>
<p>We can also quantify how well each data point is fit on average with the root mean square deviation (the square root of the mean residual) A value of zero means the curve perfectly fits the data. This is returned by <code class="docutils literal notranslate"><span class="pre">HillCurve.rmsd</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">round</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">rmsd</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.028
</pre></div></div>
</div>
<p>In general, you might consider a curve fit to be “good” if <strong>either</strong> the <code class="docutils literal notranslate"><span class="pre">r2</span></code> is close to one, or the <code class="docutils literal notranslate"><span class="pre">rmsd</span></code> is close to zero. Usually they will be correlated, but if the data essentially fall on a flat line (no or complete neutralization at all tested concentrations), then you could have a poor <code class="docutils literal notranslate"><span class="pre">r2</span></code> close to zero but still a small <code class="docutils literal notranslate"><span class="pre">rmsd</span></code> because in this case the curve would fit the data well (small <code class="docutils literal notranslate"><span class="pre">rmsd</span></code>) but would not be much better than a line (so poor <code class="docutils literal notranslate"><span class="pre">r2</span></code>) simply because the
data are basically linear.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/BloomLogo.jpg" alt="Logo" />
    
    <h1 class="logo logo-name">neutcurve</h1>
    
  </a>
</p>



<p class="blurb">Fit and plot neutralization curves</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jbloomlab&repo=neutcurve&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">neutcurve documentation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Hill-curve neutralization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Mathematical-form-of-curves">Mathematical form of curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Fitting-using-the-HillCurve-class">Fitting using the HillCurve class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Quantifying-goodness-of-fit">Quantifying goodness of fit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="curvefits_example.html">Fitting curves to real data</a></li>
<li class="toctree-l1"><a class="reference internal" href="constrain_params_range.html">Constrain fit parameters to a range of reasonable values</a></li>
<li class="toctree-l1"><a class="reference internal" href="combine_curvefits.html">Combining <code class="docutils literal notranslate"><span class="pre">CurveFits</span></code> objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_curves.html">Test curve fitting on some real data</a></li>
<li class="toctree-l1"><a class="reference internal" href="neutcurve.html">neutcurve package</a></li>
<li class="toctree-l1"><a class="reference internal" href="package_index.html">package index</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgements</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="installation.html" title="previous chapter">Installation</a></li>
      <li>Next: <a href="curvefits_example.html" title="next chapter">Fitting curves to real data</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2019--2024, Bloom lab.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/hillcurve_example.nblink.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/jbloomlab/neutcurve" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>